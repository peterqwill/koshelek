<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Управление финансами</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Транзакции</h1>
    <table>
        <tr>
            <th>Счёт</th>
            <th>Тип</th>
            <th>Сумма</th>
            <th>Описание</th>
            <th>Дата</th>
        </tr>
        {% for transaction in transactions %}
        <tr>
            <td>{{ accounts[transaction.account] }}</td>
            <td>{{ transaction.type }}</td>
            <td>{{ transaction.amount }}</td>
            <td>{{ transaction.description }}</td>
            <td>{{ transaction.date }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Добавить транзакцию</h2>
    <form action="{{ url_for('add_transaction') }}" method="post">
        <label>Счёт:</label>
        <select name="account">
            {% for key, name in accounts.items() %}
            <option value="{{ key }}">{{ name }}</option>
            {% endfor %}
        </select>
        <label>Тип:</label>
        <select name="type">
            <option value="income">Доход</option>
            <option value="expense">Расход</option>
        </select>
        <label>Сумма:</label><input type="number" name="amount" step="0.01" required>
        <label>Описание:</label><input type="text" name="description" required>
        <label>Дата:</label><input type="date" name="date" required>
        <button type="submit">Добавить</button>
    </form>

    <h2>Баланс по счетам</h2>
    <table>
        <tr>
            <th>Счёт</th>
            <th>Баланс</th>
        </tr>
        {% for account_key, account_name in accounts.items() %}
        <tr>
            <td>{{ account_name }}</td>
            <td>{{ balances[account_key] | round(2) }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Общая информация</h2>
    <div class="summary-container">
        <div class="summary-box income-box">
            <h3>Общий доход</h3>
            <p>{{ total_income | round(2) }} ₽</p>
        </div>
        <div class="summary-box expense-box">
            <h3>Общий расход</h3>
            <p>{{ total_expense | round(2) }} ₽</p>
        </div>
    </div>

    <h1>Ожидаемые приходы</h1>
    <table>
        <tr>
            <th>Счёт</th>
            <th>Сумма</th>
            <th>Описание</th>
            <th>Дата</th>
            <th>Удалить</th>
        </tr>
        {% for income in expected_incomes %}
        <tr>
            <td>{{ accounts[income.account] }}</td>
            <td>{{ income.amount }}</td>
            <td>{{ income.description }}</td>
            <td>{{ income.date }}</td>
            <td>
                <form action="{{ url_for('delete_expected_income', id=income.id) }}" method="post">
                    <button type="submit">Удалить</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <h2>Добавить ожидаемый приход</h2>
    <form action="{{ url_for('add_expected_income') }}" method="post">
        <label>Счёт:</label>
        <select name="account">
            {% for key, name in accounts.items() %}
            <option value="{{ key }}">{{ name }}</option>
            {% endfor %}
        </select>
        <label>Сумма:</label><input type="number" name="amount" step="0.01" required>
        <label>Описание:</label><input type="text" name="description" required>
        <label>Дата:</label><input type="date" name="date" required>
        <button type="submit">Добавить</button>
    </form>
</body>
</html>
